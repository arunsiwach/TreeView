SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [Direct_Benefit_Transfer_New] 
WHERE [date]=(Select max(date) from [Direct_Benefit_Transfer_New] (nolock) where [date]<= @datevalue )--and project_code=100383)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
and project_code=100137
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from PM_SVANidhi
WHERE [date]=(Select max(date) from PM_SVANidhi (nolock) where [date]<= @datevalue )--and project_code=100383)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END  
and Actual_Flag='Cumulative' and Data_freq='Daily'

group by project_code,project_name,[label],indicator,[date]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from PM_SVANidhi
WHERE [date]=(Select max(date) from PM_SVANidhi (nolock) where [date]<= @datevalue )--and project_code=100383)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END  
and Actual_Flag='Current'  and Data_freq='Daily'
group by project_code,project_name,[date],[label],indicator
--order by project_code,[label] -- Actual flag is current but value is like cumulative
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from Swachh_Bharat_Mission_Grameen_New_Daily 
WHERE [date]=(Select max(date) from Swachh_Bharat_Mission_Grameen_New_Daily (nolock) where [date]<= @datevalue )--and project_code=100383)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END  
and data_freq='Daily'
--and project_code=70032
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [Swachh Bharat Mission Urban] 
WHERE [date]=(Select max(date) from [Swachh Bharat Mission Urban] (nolock) where [date]<= @datevalue )--and project_code=100383)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
--and project_code=70032
group by project_code,project_name,[label],indicator,[date]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [Sukanya Samriddhi Yojana] 
WHERE [date]=(Select max(date) from [Sukanya Samriddhi Yojana] (nolock) where [date]<= @datevalue )--and project_code=100383)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
--and project_code=70032
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from startups_recognized_latest 
WHERE [date]=(Select max(date) from startups_recognized_latest (nolock) where [date]<= @datevalue )--and project_code=100383)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
--and project_code=70032
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/

declare @standdate date
set @standdate=(Select max(date) from [Stand Up India] (nolock) where [date]<= @datevalue and project_code=70019)
SELECT  project_code,project_name,[label],indicator,@standdate as [date],
sum([value]) as national_value
from [Stand Up India]
WHERE [date]<=@standdate
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
and project_code=70019
group by project_code,project_name,[label],indicator
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [Routine Immunization_New] 
WHERE [date]=(Select max(date) from [Routine Immunization_New] (nolock) where [date]<= @datevalue )--and project_code=100383)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
--and project_code=70032
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from PMNDP_Programme_Daily 
WHERE [date]=(Select max(date) from PMNDP_Programme_Daily (nolock) where [date]<= @datevalue )--and project_code=100383)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
and data_freq='Daily'
--and project_code=70032
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from PMSBY 
WHERE [date]=(Select max(date) from PMSBY (nolock) where [date]<= @datevalue )--and project_code=100383)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
--and project_code=70032
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from PM_POSHAN 
WHERE [date]=(Select max(date) from PM_POSHAN (nolock) where [date]<= @datevalue )--and project_code=70032)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
--and project_code=70032
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [Nationwide Artificial Insemination Progr_update] 
WHERE [date]=(Select max(date) from [Nationwide Artificial Insemination Progr_update] (nolock) where [date]<= @datevalue )--and project_code=70032)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
--and Data_freq IN('Daily')
--and project_code=70032
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from PMMY 
WHERE [date]=(Select max(date) from PMMY (nolock) where [date]<= @datevalue )--and project_code=70032)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
--and project_code=70032
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
declare @matsyadate date
set @matsyadate=(Select max(date) from [PM Matsya Sampada] (nolock) where [date]<= @datevalue )
SELECT  project_code,project_name,[label],indicator,(Select max(date) from [PM Matsya Sampada] (nolock) where [date]<= @datevalue ) as [date]
,sum([value]) as national_value
from [PM Matsya Sampada]
WHERE [date]<=(Select max(date) from [PM Matsya Sampada] (nolock) where [date]<= @datevalue )
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator

/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from pm_matru_vandana_updated 
WHERE [date]=(Select max(date) from pm_matru_vandana_updated (nolock) where [date]<= @datevalue )--and project_code=70032)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
--and project_code=70032
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from PM_kisan_samman_nidhi_latest 
WHERE [date]=(Select max(date) from PM_kisan_samman_nidhi_latest (nolock) where [date]<= @datevalue )--and project_code=70032)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
--and project_code=70032
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from PMJJBY 
WHERE [date]=(Select max(date) from PMJJBY (nolock) where [date]<= @datevalue )--and project_code=70032)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
--and project_code=70032
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from PMJDY 
WHERE [date]=(Select max(date) from PMJDY (nolock) where [date]<= @datevalue and project_code=70032)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
and project_code=70032
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [PM Fasal Bima Yojana_New] 
WHERE [date]=(Select max(date) from [PM Fasal Bima Yojana_New] (nolock) where [date]<= @datevalue )--and project_code=100646)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [National Agriculture Market] 
WHERE [date]=(Select max(date) from [National Agriculture Market] (nolock) where [date]<= @datevalue )--and project_code=100646)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,
(Select max(date) from [ujala] (nolock) where [date]<= @datevalue and project_code=70051) as [date] 
,sum([value]) as national_value
from [ujala] 
WHERE [date]<=(Select max(date) from [ujala] (nolock) where [date]<= @datevalue and project_code=70051)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
and project_code='70051'
group by project_code,project_name,[label],indicator
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [pm_awaas_yojana_urban_weekly] 
WHERE [date]=(Select max(date) from [pm_awaas_yojana_urban_weekly] (nolock) where [date]<= @datevalue and project_code=100201)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
and project_code='100201'
and data_freq in ('Weekly')  
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [pradhan mantri gram sadak yojana] 
WHERE [date]=(Select max(date) from [pradhan mantri gram sadak yojana] (nolock) where [date]<= @datevalue )--and project_code=100646)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [deendayal antyodaya yojana nrlm] 
WHERE [date]=(Select max(date) from [deendayal antyodaya yojana nrlm] (nolock) where [date]<= @datevalue and project_code=70010)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
and project_code=70010--'100156'
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
Declare @svamitdate date
set @svamitdate=(Select max(date) from [svamitva scheme] (nolock) where [date]<= @datevalue )
SELECT  project_code,project_name,[label],indicator,@svamitdate as [date]
,sum([value]) as national_value
from [svamitva scheme] 
WHERE [date]<=@svamitdate--and project_code=100396)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [pradhan mantri awaas yojana gramin] 
WHERE [date]=(Select max(date) from [pradhan mantri awaas yojana gramin] (nolock) where [date]<= @datevalue )--and project_code=70010)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [PM_DASBOARD_MGNREGA_Updated] 
WHERE [date]=(Select max(date) from [PM_DASBOARD_MGNREGA_Updated] (nolock) where [date]<= @datevalue )--and project_code=70010)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
and data_freq in ('Weekly')
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/

DECLARE @MindateNonMonthly varchar(30)='',@maxdate varchar(30)='',@IsMnth bit=0
Declare @datafreqtbl table (FreqName varchar(50),Id char(2) )
Insert @datafreqtbl
Select 'Daily','NM' UNION Select 'Weekly','NM' UNION Select 'Fortnightly','NM' UNION Select 'Monthly','MM'

select @MindateNonMonthly= isnull(min([date]),'') from [JJM_Daily_Blocks_Villages_updated] where data_freq NOT IN ('Monthly')
if(@MindateNonMonthly != '') begin 
	SET @IsMnth = CASE when @maxdate<@MindateNonMonthly then 1 else 0 end 
end

SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
--SELECT  project_code,project_name,[label],indicator,@datevalue,sum([value]) as national_value
from [JJM_Daily_Blocks_Villages_updated] 
WHERE [date]=(Select max(date) from [JJM_Daily_Blocks_Villages_updated] (nolock) where [date]<= @datevalue )--and project_code=70010)  
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
and data_freq IN (Select FreqName from @datafreqtbl where Id = CASE when @IsMnth=1 then 'MM' else 'NM' end )
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [Agriculture Infrastructure Fund](nolock)
WHERE [date]=(Select max(date) from [Agriculture Infrastructure Fund](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
and Data_freq IN('Daily')
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from AB_Health_Wellness_Centres (nolock)
WHERE [date]=(Select max(date) from [AB_Health_Wellness_Centres](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
and data_freq IN ('Weekly')
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [Development of National Highways]
WHERE [date]=(Select max(date) from [Development of National Highways] (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [Common Services Centre](nolock)
WHERE [date]=(Select max(date) from [Common Services Centre](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]
--order by project_code,[label]
/*---block---*/
DECLARE @bharatnetdate date
set @bharatnetdate=(Select max(date) from [BharatNet_CurrentMonth](nolock) where [date]<= @datevalue)
SELECT  project_code,project_name,[label],indicator,@bharatnetdate as [date]
,sum([value]) as national_value
from [BharatNet_CurrentMonth](nolock)
WHERE [date]<=@bharatnetdate 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   	
group by project_code,project_name,[label],indicator
--order by project_code,[label]
/*---block---*/
DECLARE @pmajaydate date
set  @pmajaydate=(Select max(date) from [AB PMJAY daily](nolock) where [date]<= @datevalue)
SELECT  project_code,project_name,[label],indicator,@pmajaydate as [date] ,sum([Current_Value]) as national_value
from [AB PMJAY daily](nolock)	
WHERE [date]<=@pmajaydate
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator
--order by project_code,[label]
/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from APY (nolock)
WHERE [date]=(Select max(date) from [APY](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]

/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [ONORC_v3] (nolock)
WHERE [date]=(Select max(date) from [ONORC_v3](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]


/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from Direct_Benefit_Transfer_New (nolock)
WHERE [date]=(Select max(date) from Direct_Benefit_Transfer_New(nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
and project_code=100137
group by project_code,project_name,[label],indicator,[date]

-----------------------------------------------------------------------------------------critical schemes ends here----------------------------------------------------------------------
/*---block---*/ 
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [Direct Benefit Transfer for LPG DBTL](nolock)
WHERE [date]=(Select max(date) from [Direct Benefit Transfer for LPG DBTL](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]

/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [Gram Panchayat Development Plan GPDP](nolock)
WHERE [date]=(Select max(date) from [Gram Panchayat Development Plan GPDP](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]

/*---block---*/ 

SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [DILRM](nolock)
WHERE [date]=(Select max(date) from [DILRM](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]


/*---block---*/
SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [INSPIRE](nolock)
WHERE [date]=(Select max(date) from [INSPIRE](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [eTaal](nolock)
WHERE [date]=(Select max(date) from [eTaal](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,[date],sum([value]) as national_value
from [INSPIRE Awards MANAK](nolock)
WHERE [date]=(Select max(date) from [INSPIRE Awards MANAK](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]


/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date] ,
sum([Cumulative_Value]) as national_value
from [DDU GKY](nolock)
WHERE [date]=(Select max(date) from [DDU GKY](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]

/*---block---*/ 



SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [Coal Production](nolock)
WHERE [date]=(Select max(date) from [Coal Production](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [Capacity Building](nolock)
WHERE [date]=(Select max(date) from [Capacity Building](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [EPFO Payroll](nolock)
WHERE [date]=(Select max(date) from [EPFO Payroll](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]

/*---block---*/


SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [CAPEX_New](nolock)
WHERE [date]=(Select max(date) from [CAPEX_New](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]

/*---block---*/


SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [Services Trade I/E](nolock)
WHERE [date]=(Select max(date) from [Services Trade I/E](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Value]) as national_value
from [Defence Production](nolock)
WHERE [date]=(Select max(date) from [Defence Production](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [Coal_Dispatch](nolock)
WHERE [date]=(Select max(date) from [Coal_Dispatch](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [MEA_new](nolock)
WHERE [date]=(Select max(date) from [MEA_new](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END   
and project_code=100407
group by project_code,project_name,[label],indicator,[date]

/*---block---*/


SELECT  project_code,project_name,[label],indicator,
[date],
sum([Value]) as national_value
from [I/E Commodity Wise](nolock)
WHERE [date]=(Select max(date) from [I/E Commodity Wise](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [Biotech Intervention(Aspirational Distt)](nolock)
WHERE [date]=(Select max(date) from [Biotech Intervention(Aspirational Distt)](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/


SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [Area protected](nolock)
WHERE [date]=(Select max(date) from [Area protected](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [CGTMSE](nolock)
WHERE [date]=(Select max(date) from [CGTMSE](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]


/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [DEFENCE OFFSET](nolock)
WHERE [date]=(Select max(date) from [DEFENCE OFFSET](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [Innovations for Defence Excellence](nolock)
WHERE [date]=(Select max(date) from [Innovations for Defence Excellence](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [AI IN DEFENCE](nolock)
WHERE [date]=(Select max(date) from [AI IN DEFENCE](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [ABRY_Weekly](nolock)
WHERE [date]=(Select max(date) from [ABRY_Weekly](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [eSHRAM](nolock)
WHERE [date]=(Select max(date) from [eSHRAM](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/


SELECT  project_code,project_name,[label],indicator,
[date],
sum([cumulative_value]) as national_value
from [ESI CORPORATION](nolock)
WHERE [date]=(Select max(date) from [ESI CORPORATION](nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/ 


SELECT  project_code,project_name,[label],indicator,
[date],
sum([cumulative_value]) as national_value
from [Defence Exports](nolock)
WHERE [date]=(Select max(date) from [Defence Exports] (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]


/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([cumulative_value]) as national_value
from [HRD Activities](nolock)
WHERE [date]=(Select max(date) from [HRD Activities] (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/ 

SELECT  project_code,project_name,[label],indicator,
[date],
sum([cumulative_value]) as national_value
from [Integrated Cold Chain](nolock)
WHERE [date]=(Select max(date) from [Integrated Cold Chain] (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([cumulative_value]) as national_value
from [CEFPPC](nolock)
WHERE [date]=(Select max(date) from [CEFPPC] (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]


/*---block---*/ 

---dated : 1 jul 25
SELECT  project_code,project_name,[label],indicator,
[date],
sum([cumulative_value]) as national_value
from [Food Safety](nolock)
WHERE [date]=(Select max(date) from [Food Safety] (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/ 

SELECT  project_code,project_name,[label],indicator,
[date],
sum([cumulative_value]) as national_value
from [India Post Payment New_Daily](nolock)
WHERE [date]=(Select max(date) from [India Post Payment New_Daily] (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([cumulative_value]) as national_value
from [Agri Clinics and Business](nolock)
WHERE [date]=(Select max(date) from [Agri Clinics and Business] (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([cumulative_value]) as national_value
from [Ease_of_Doing_Business_updated](nolock)
WHERE [date]=(Select max(date) from [Ease_of_Doing_Business_updated] (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
and project_code=100449
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([cumulative_value]) as national_value
from [Extension Reforms (ATMA)] (nolock)
WHERE [date]=(Select max(date) from [Extension Reforms (ATMA)]  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_value]) as national_value
from [DigiLocker_new] (nolock)
WHERE [date]=(Select max(date) from [DigiLocker_new]  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/


SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_value]) as national_value
from [5G_BTS] (nolock)
WHERE [date]=(Select max(date) from [5G_BTS]  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]


/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_value]) as national_value
from [Amrit_Bharat_Stations] (nolock)
WHERE [date]=(Select max(date) from [Amrit_Bharat_Stations]  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_value]) as national_value
from [Government_emarketplace] (nolock)
WHERE [date]=(Select max(date) from [Government_emarketplace]  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_value]) as national_value
from [aishe] (nolock)
WHERE [date]=(Select max(date) from [aishe]  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_value]) as national_value
from [Craftsmen_Training_Scheme_ITI] (nolock)
WHERE [date]=(Select max(date) from [Craftsmen_Training_Scheme_ITI]  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/
SELECT  project_code,project_name,[label],indicator,
[date],
sum([value]) as national_value
from [GPs_connected_currmonth] (nolock)
WHERE [date]=(Select max(date) from [GPs_connected_currmonth]  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/


SELECT  project_code,project_name,[label],indicator,
[date],
sum([value]) as national_value
from [Women_Helpline] (nolock)
WHERE [date]=(Select max(date) from [Women_Helpline]  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([value]) as national_value
from [DEFENCE CORRIDOR] (nolock)
WHERE [date]=(Select max(date) from [DEFENCE CORRIDOR]  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
and project_code=100666
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([value]) as national_value
from Fertilizers (nolock)
WHERE [date]=(Select max(date) from Fertilizers  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
and project_code=100122
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([value]) as national_value
from [Income Tax Department] (nolock)
WHERE [date]=(Select max(date) from [Income Tax Department]  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [IR_OPERATIONS_CAPEX] (nolock)
WHERE [date]=(Select max(date) from [IR_OPERATIONS_CAPEX]  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
--and Data_freq='Monthly'
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from IR_PROJECTS (nolock)
WHERE [date]=(Select max(date) from IR_PROJECTS  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from IVFRT (nolock)
WHERE [date]=(Select max(date) from IVFRT  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from Jan_Sikshan_Sansthan (nolock)
WHERE [date]=(Select max(date) from Jan_Sikshan_Sansthan  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [MAKE II PROJECTS] (nolock)
WHERE [date]=(Select max(date) from [MAKE II PROJECTS]  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from MCA_Daily (nolock)
WHERE [date]=(Select max(date) from MCA_Daily  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/


SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [Mega Food Parks] (nolock)
WHERE [date]=(Select max(date) from [Mega Food Parks]  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [Merchandise Trade Export and Import] (nolock)
WHERE [date]=(Select max(date) from [Merchandise Trade Export and Import]  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]


/*---block---*/


SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from Mission_Raksha_Gyan (nolock)
WHERE [date]=(Select max(date) from Mission_Raksha_Gyan  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from Mission_Saksham_Anganwadi (nolock)
WHERE [date]=(Select max(date) from Mission_Saksham_Anganwadi  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]


/*---block---*/

SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from [Merit cum Means based] (nolock)
WHERE [date]=(Select max(date) from [Merit cum Means based]  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

/*---block---*/


SELECT  project_code,project_name,[label],indicator,
[date],
sum([Cumulative_Value]) as national_value
from Minority_Post_Matric (nolock)
WHERE [date]=(Select max(date) from Minority_Post_Matric  (nolock) where [date]<= @datevalue) 
AND [label]=CASE WHEN @kpiid=0  THEN [label] ELSE @kpiid END  
and state_code=CASE WHEN @stateid=0  THEN state_code ELSE @stateid END 
group by project_code,project_name,[label],indicator,[date]

